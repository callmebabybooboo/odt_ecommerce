<div class="max-w-4xl mx-auto bg-white shadow p-6 rounded">
    <h1 class="text-2xl font-bold text-green-600 mb-4">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h1>

    <p class="text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç: <strong>#<%= @order.id %></strong></p>
    <p class="text-gray-700 mb-2">‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: <strong><%= @order.user.email %></strong></p>
    <p class="text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: <%= l(@order.created_at, format: :long) %></p>
    <p class="text-gray-700 mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á: <%= @order.delivery_method %></p>
    <% if @order.delivery_method == "‡∏à‡∏±‡∏î‡∏™‡πà‡∏á" %>
        <p class="text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö: <%= @order.shipping_name %></p>
        <p class="text-gray-700 mb-2">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á: <%= @order.shipping_address %></p>
        <p class="text-gray-700 mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: <%= @order.phone_number %></p>
    <% end %>
    <p class="text-gray-700 mb-2">‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô: <%= @order.payment_method %></p>
    <p class="text-gray-700 mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <%= render_order_status(@order) %></p>


    <table class="w-full text-left mb-4">
        <thead>
            <tr class="border-b">
                <th class="py-2">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th class="py-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th class="py-2">‡∏£‡∏≤‡∏Ñ‡∏≤</th>
                <th class="py-2">‡∏£‡∏ß‡∏°</th>
            </tr>
        </thead>
        <tbody>
            <% if @order.order_items.present? %>
                <% @order.order_items.each do |item| %>
                    <tr class="border-b">
                        <td class="text-gray-700 py-2"><%= item.product.name %></td>
                        <td class="text-gray-700 py-2"><%= item.quantity %></td>
                        <td class="text-gray-700 py-2"><%= number_to_currency(item.price, unit: "‡∏ø") %></td>
                        <td class="text-gray-700 py-2"><%= number_to_currency(item.total_price, unit: "‡∏ø") %></td>
                    </tr>
                <% end %>
            <% else %>
                <p class="text-red-600">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ô‡∏µ‡πâ</p>
            <% end %>
        </tbody>
    </table>

    <div class="text-right font-bold text-lg">
        ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <%= number_to_currency(@order.total_price, unit: "‡∏ø") %>
    </div>

    <% if @order.payment_method == "‡πÇ‡∏≠‡∏ô" %>
        <% if @order.payment_slip_url.present? %>
            <div>
                <h3 class="font-semibold mb-2">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
                <%= image_tag @order.payment_slip_url, class: "rounded shadow border w-64 h-auto" %>
            </div>
        <% else %>
            <p class="text-gray-600 italic mt-6">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
        <% end %>

        <% if @order.pending? %>
            <div class="mt-6">
                <h2 class="text-lg font-bold text-gray-800 mb-2">üì≤ ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
                <%= image_tag "QR-code.png", alt: "PromptPay QR", class: "w-100 h-100 mx-auto" %>

                <div data-controller="slip-preview">
                    <%= form_with model: @order, url: upload_slip_order_path(@order), method: :patch, local: true do |f| %>
                        <div>
                            <%= f.label :payment_slip_url, "‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå URL ‡∏Ç‡∏≠‡∏á‡∏™‡∏•‡∏¥‡∏õ", class: "block font-medium" %>
                            <div class="text-sm text-gray-500 mt-2" data-slip-preview-target="placeholder">
                            ‡∏ß‡∏≤‡∏á URL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏•‡∏¥‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
                            </div>
                            <%= f.text_field :payment_slip_url,
                                class: "border rounded p-2 w-full",
                                data: {
                                    action: "input->slip-preview#preview",
                                    slip_preview_target: "input"
                                } %>
                        </div>

                        <div class="mt-3" data-slip-preview-target="preview"></div>

                        <div class="flex justify-end mt-2 mb-4">
                            <%= f.submit "‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ", class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded" %>
                        </div>
                    <% end %>
                </div>

                <div class="text-right">
                    <%= link_to "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠", cancel_order_path(@order), method: :patch,
                        data: { turbo_method: :patch, confirm: "‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å?" },
                        class: "bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded" %>
                </div>
            </div>
        <% end %>
    <% end %>

</div>
